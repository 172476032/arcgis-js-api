// COPYRIGHT Â© 201 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/3.23/esri/copyright.txt for details.

define(["./_SectionJsonCollector"],function(o){var n={},e="field",s={process:function(o,n,e,c,i){var t=c;c=function(o,n,e){o&&t.apply(this,arguments)};var r={processLevel:n,objJson:e,processFunc:c,ignoreComparisonCalculators:i&&i.ignoreComparisonCalculators};if(o===n)return void c(e);"document"===o?s._processTemplateJson(e,r):"section"===o?s._processSectionJson(e,r):"table"===o?s._processTableJson(e,r):"tableRow"===o&&s._processTableDataObj(e,r)},_processTemplateJson:function(n,c){o.collectSectionJsons(n,{saveParentInfo:!1,processFieldInfoFunc:function(o){c.processLevel===e&&c.processFunc(o)}}).forEach(function(o){s._processSectionJson(o,c)})},_processSectionJson:function(o,n){if("section"===n.processLevel)return void n.processFunc(o);o.stack.forEach(function(o){"sectionElement"===n.processLevel?n.processFunc(o):"table"===o.id&&("table"===n.processLevel?n.processFunc(o):s._processTableJson(o,n))})},_processTableJson:function(o,n,e){o.data.data.forEach(function(o){"tableRow"===n.processLevel?(n.processFunc(o,e),s._processTableDataObj(o,n,e)):s._processTableDataObj(o,n,e)}),o.backgroundSectionJson&&s._processSectionJson(o.backgroundSectionJson,n),o.foregroundSectionJson&&s._processSectionJson(o.foregroundSectionJson,n),o.floatingTablesSectionJson&&s._processSectionJson(o.floatingTablesSectionJson,n)},_processTableDataObj:function(o,n,e){if(o.fieldInfos)for(var c in o.fieldInfos)s._processFieldInfo(o.fieldInfos[c],n,e)},_processFieldInfo:function(o,n,c){function i(o,s){n.processLevel===e&&n.processFunc(o,s)}if(o){if(i(o,c),function(o){o&&o.triggerJson&&o.triggerJson.fieldInfo&&o.templateName!==o.triggerJson.fieldInfo.templateName&&i(o.triggerJson.fieldInfo,o)}(o),o.linkFieldInfo&&i(o.linkFieldInfo,o),o.isInfographic&&(o.infographicJson.header&&s._processTableJson(o.infographicJson.header,n,o),o.infographicJson.variableTables&&o.infographicJson.variableTables.forEach(function(e){e.variable&&s._processFieldInfo(e.variable.fieldInfo,n,o),e.description&&e.description.fieldInfo&&s._processFieldInfo(e.description.fieldInfo,n,o)}),!n.ignoreComparisonCalculators&&o.infographicJson.fieldInfos&&o.infographicJson.fieldInfos.forEach(function(e){s._processFieldInfo(e,n,o)}),o.infographicJson.dataDrilling))for(var t in o.infographicJson.dataDrilling){var r=o.infographicJson.dataDrilling[t];r&&r.sectionJson&&s._processSectionJson(r.sectionJson,n)}if(o.isRichText&&(o.richTextJson.fieldInfos.forEach(function(e){s._processFieldInfo(e,n,o)}),o.richTextJson.specialFieldInfos.forEach(function(e){s._processFieldInfo(e,n,o)})),o.isChart){var a=o.chartJson.visualProperties;a.chartIcons&&a.chartIcons.forEach(function(e){s._processFieldInfo(e,n,o)}),a.floatingIcons&&a.floatingIcons.forEach(function(e){s._processTableJson(e,n,o)}),a.floatingTexts&&a.floatingTexts.forEach(function(e){s._processTableJson(e,n,o)}),o.chartJson.seriesItems.forEach(function(e){e.points.forEach(function(e){n.ignoreComparisonCalculators&&o.chartJson.comparisonInfo||s._processFieldInfo(e.fieldInfo,n,o),e.iconFieldInfo&&s._processFieldInfo(e.iconFieldInfo,n,o),e.captionFieldInfo&&s._processFieldInfo(e.captionFieldInfo,n,o)})})}o.isReportSection&&o.sectionJson&&s._processSectionJson(o.sectionJson,n)}}};return n.DOCUMENT="document",n.SECTION="section",n.TABLE="table",n.SECTION_ELEMENT="sectionElement",n.TABLE_ROW="tableRow",n.FIELD=e,n.process=s.process,n.processTemplateFieldInfos=function(o,n,c){s.process("document",e,o,n,c)},n.processSectionFieldInfos=function(o,n,c){s.process("section",e,o,n,c)},n.processSectionElements=function(o,n){s.process("document","sectionElement",o,n)},n.processTableFieldInfos=function(o,n,c){s.process("table",e,o,n,c)},n.hasMultiFeatureChart=function(o){var e=!1;return n.processSectionFieldInfos(o,function(o){e=e||o.isChart&&o.chartJson&&!!o.chartJson.isMultiFeatureChart}),e},n.isGraphicReport=function(o){return!!o.sectionsTables},n.hasLocatorCalculators=function(o){return n._checkTableAttributes(o,function(o){return!!o.locatorSettings})},n.hasDynamicColumns=function(o){return n._checkTableAttributes(o,function(o){return o.dynamicColumns>0})},n.hasDynamicRows=function(o){return n._checkTableAttributes(o,function(o){return o.dynamicRows>0})},n._checkTableAttributes=function(n,e){return o.collectSectionJsons(n).some(function(o){return o.stack.some(function(o){if("table"===o.id)return!(!o.attributes||!e(o.attributes))||void 0})})},n.collectSectionJsons=o.collectSectionJsons,n.getParentBox=o.getParentBox,n.getParentStyle=o.getParentStyle,n});