// COPYRIGHT Â© 2017 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/3.23/esri/copyright.txt for details.

define(["dojo/_base/lang","dojox/charting/Theme","../../themes/ThemeLibrary","./ChartTypes","./plots/supportClasses/GaugeLabelPlacement"],function(e,o,r,n,a){function t(e,o){var r,a=o;switch(e){case n.COLUMN:r=a.column&&a.column.colors;break;case n.LINE:r=a.line&&a.line.colors;break;case n.BAR:r=a.bar&&a.bar.colors;break;case n.PIE:r=a.pie&&a.pie.colors;break;case n.DONUT:r=a.donut&&a.donut.colors;break;case n.GAUGE:r=a.gauge&&a.gauge.colors;break;case n.RING:r=a.ring&&a.ring.colors}return r&&r.length||(r=null),r||a.colors||l}var i={},l=["#AAAAAA","#888888","#555555","#333333"];return i.DEFAULT_LINE_THICKNESS=1,i.DEFAULT_COLUMN_THICKNESS="Medium",i.DEFAULT_DONUT_HOLE_PERCENT=50,i.DEFAULT_DONUT_GAP=3,i.DEFAULT_DONUT_ARC_PERCENT=100,i.DEFAULT_GAUGE_HOLE_PERCENT=80,i.DEFAULT_GAUGE_GAP=2,i.DEFAULT_GAUGE_ANGLE=0,i.DEFAULT_GAUGE_ARC_PERCENT=100,i.getThemeForSettings=function(r,a){var t=a,c=new o({colors:t.colors||l});if(!r)return c;var s=r.visualProperties;c.plotarea.fill=s.backgroundColor||t.backgroundColor,c.plotarea.stroke={width:0},c.chart.fill="transparent",c.axis.title.font="normal normal normal 11px Verdana",!n.isPieLike(r.type)&&r.type!==n.RING&&s.backgroundImageData&&(c.plotarea.backgroundImageData=s.backgroundImageData);var u=e.mixin({},t.dataLabelsStyle,s.dataLabelsStyle);if(u.color&&(c.series.fontColor=u.color),c.series.font=i.combineFontString(u),c.series.showColumnBarBackground=s.showColumnBarBackground,c.series.columnBarBackgroundColor=s.columnBarBackgroundColor||t.columnBarBackground&&t.columnBarBackground.backgroundColor,r.type===n.DONUT&&(c.series.donutHolePercent=void 0!==s.donutHolePercent?s.donutHolePercent:i.DEFAULT_DONUT_HOLE_PERCENT,c.series.donutGap=void 0!==s.donutGap?s.donutGap:i.DEFAULT_DONUT_GAP,c.series.donutArcPercent=void 0!==s.donutArcPercent?s.donutArcPercent:i.DEFAULT_DONUT_ARC_PERCENT,c.series.donutArcPercent=Math.min(100,Math.max(50,c.series.donutArcPercent))),r.type===n.GAUGE){c.series.donutHolePercent=void 0!==s.gaugeHolePercent?s.gaugeHolePercent:i.DEFAULT_GAUGE_HOLE_PERCENT,c.series.donutGap=void 0!==s.gaugeGap?s.gaugeGap:i.DEFAULT_GAUGE_GAP,c.series.startAngle=void 0!==s.gaugeStartAngle?s.gaugeStartAngle:i.DEFAULT_GAUGE_ANGLE,c.series.donutArcPercent=void 0!==s.gaugeArcPercent?s.gaugeArcPercent:i.DEFAULT_GAUGE_ARC_PERCENT,c.series.donutArcPercent=Math.min(100,Math.max(50,c.series.donutArcPercent)),c.series.donutShowIcons=s.showChartIcons,s.gaugeShowArrow&&(c.series.donutShowArrowIndicator=!0,c.series.donutGap=0,100!==c.series.donutArcPercent&&(c.series.startAngle=0),c.series.donutArrowIndicatorLineColor=s.gaugeArrowLineColor||t.gauge&&t.gauge.arrowIndicator.lineColor,c.series.donutArrowIndicatorFillColor=s.gaugeArrowFillColor||t.gauge&&t.gauge.arrowIndicator.backgroundColor);var g=e.mixin({},t.gauge&&t.gauge.dataLabelStyle,s.gaugeLabelStyle);c.series.donutMainLabelPosition=s.gaugeLabelPlacement,c.series.donutMainLabelFont=i.combineFontString(g),c.series.donutMainLabelFontColor=g.color,c.series.donutMainLabelFontSize=s.gaugeLabelStyle&&s.gaugeLabelStyle.fontSize,c.series.donutMainLabelTextDecoration=g.textDecoration}return r.type===n.RING&&(c.series.show100PercentLabel=!0,c.series.ringBackgroundColor=s.ringBackgroundColor||t.ring&&t.ring.ringBackground&&t.ring.ringBackground.backgroundColor),n.isPictureLike(r.type)&&(c.series.showWholePictures=s.showWholePictures),c.marker.fill="#FFFFFF",c},i.getComparisonSymbol=function(){return"m-3,0 c0,-4 6,-4 6,0, m-6,0 c0,4 6,4 6,0"},i.calcColorForPoint=function(e,o,r,a,i,l,c,s,u){var g,d,F=n.isPieLike(l)||!c.renderSingleDataSeriesWithSameColor&&1===i,A=t(l,c);if(l===n.LINE)s&&u?d=u.color||c.comparisonInfo.lineColor:(g=A[a%A.length],d=o.color||g||"#FFFFFF");else if(s&&u&&u.color)d=u.color;else{if(l===n.GAUGE&&1===r&&c.gauge.othersColor)return e&&e.color||c.gauge.othersColor;g=g||(F?A[r%A.length]:A[a%A.length]),d=e&&e.color||!n.isPieLike(l)&&o.color||g||"#FFFFFF"}return d},i.calcColorForSeries=function(e,o,r,a,i){var l,c,s=n.isPieLike(a)||!i.renderSingleDataSeriesWithSameColor&&1===r,u=t(a,i);if(a===n.LINE)l=u[o%u.length],c=e&&e.color||l||"#FFFFFF";else var l=s?null:u[o%u.length],c=e&&e.color||l||"#FFFFFF";return c},i.provideMissingIconsForPoints=function(o,r){if(!n.isPictureLike(r))return null;var a,t=[];o.forEach(function(o){o.iconFieldInfo?(a=o.iconFieldInfo,t.forEach(function(o){o.iconFieldInfo=e.clone(a)}),t.length=0):a?o.iconFieldInfo=e.clone(a):t.push(o)})},i.calcIconForPoint=function(e,o,r){if(!n.isPictureLike(r))return null;var a=e.iconFieldInfo;return a&&a.shapeJson&&o&&(a.shapeJson.themeStyle={fillColor:o,borderColor:o}),a},i.calcBackgroundIconForPoint=function(o,r,a,t){if(!n.isPictureLike(r))return null;var i=t.columnBarBackgroundColor||a.columnBarBackground&&a.columnBarBackground.backgroundColor,l=o.iconFieldInfo;return l&&l.shapeJson&&i?(l=e.clone(l),l.shapeJson.themeStyle={fillColor:i,borderColor:i},l):null},i.combineFontString=function(e){e=e||{};var o=e.fontStyle||"normal",n=e.fontWeight||"normal",a=(e.fontSize||"11")+"px",t=e.fontFamily||r.DEFAULT_FONT_FAMILY_CLASSIC;return o+" normal "+n+" "+a+" "+t},i});