// COPYRIGHT Â© 201 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/3.25/esri/copyright.txt for details.

define(["dojo/_base/lang","dojox/charting/Theme","../../themes/ThemeLibrary","./ChartTypes","./ChartLineMarkers","./plots/supportClasses/GaugeLabelPlacement","../../supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder"],function(e,o,r,n,a,i,t){function l(e,o){var r,a=o;switch(e){case n.COLUMN:r=a.column&&a.column.colors;break;case n.BAR:r=a.bar&&a.bar.colors;break;case n.LINE:r=a.line&&a.line.colors;break;case n.PIE:r=a.pie&&a.pie.colors;break;case n.DONUT:r=a.donut&&a.donut.colors;break;case n.GAUGE:r=a.gauge&&a.gauge.colors;break;case n.RING:r=a.ring&&a.ring.colors;break;case n.PICTURE_COLUMN:r=a.pictureColumn&&a.pictureColumn.colors;break;case n.PICTURE_BAR:r=a.pictureBar&&a.pictureBar.colors}return r&&r.length||(r=null),r||a.colors||c}var s={},c=["#AAAAAA","#888888","#555555","#333333"];return s.DEFAULT_LINE_THICKNESS=1,s.DEFAULT_COLUMN_THICKNESS="Medium",s.DEFAULT_DONUT_HOLE_PERCENT=50,s.DEFAULT_DONUT_GAP=3,s.DEFAULT_DONUT_ARC_PERCENT=100,s.DEFAULT_GAUGE_HOLE_PERCENT=80,s.DEFAULT_GAUGE_GAP=2,s.DEFAULT_GAUGE_ANGLE=0,s.DEFAULT_GAUGE_ARC_PERCENT=100,s.getThemeForSettings=function(r,a){var i=a,l=new o({colors:i.colors||c});if(!r)return l;var u=r.visualProperties;l.plotarea.fill=u.backgroundColor||i.backgroundColor,l.plotarea.stroke={width:0},l.chart.fill="transparent",l.axis.title.font="normal normal normal 11px Verdana",!n.isPieLike(r.type)&&r.type!==n.RING&&u.backgroundImageData&&(l.plotarea.backgroundImageData=u.backgroundImageData);var g=e.mixin({},i.dataLabelsStyle,u.dataLabelsStyle);if(g.color&&(l.series.fontColor=g.color),l.series.font=s.combineFontString(g),l.series.showColumnBarBackground=u.showColumnBarBackground,l.series.columnBarBackgroundColor=u.columnBarBackgroundColor||i.columnBarBackground&&i.columnBarBackground.backgroundColor,l.series.renderColumnBarsInOppositeDirections=u.renderColumnBarsInOppositeDirections,l.series.baseLineValue=u.yAxis.baseLineValue,r.type===n.DONUT&&(l.series.donutHolePercent=void 0!==u.donutHolePercent?u.donutHolePercent:s.DEFAULT_DONUT_HOLE_PERCENT,l.series.donutGap=void 0!==u.donutGap?u.donutGap:s.DEFAULT_DONUT_GAP,l.series.donutArcPercent=void 0!==u.donutArcPercent?u.donutArcPercent:s.DEFAULT_DONUT_ARC_PERCENT,l.series.donutArcPercent=Math.min(100,Math.max(50,l.series.donutArcPercent))),r.type===n.GAUGE){l.series.donutHolePercent=void 0!==u.gaugeHolePercent?u.gaugeHolePercent:s.DEFAULT_GAUGE_HOLE_PERCENT,l.series.donutGap=void 0!==u.gaugeGap?u.gaugeGap:s.DEFAULT_GAUGE_GAP,l.series.startAngle=void 0!==u.gaugeStartAngle?u.gaugeStartAngle:s.DEFAULT_GAUGE_ANGLE,l.series.donutArcPercent=void 0!==u.gaugeArcPercent?u.gaugeArcPercent:s.DEFAULT_GAUGE_ARC_PERCENT,l.series.donutArcPercent=Math.min(100,Math.max(50,l.series.donutArcPercent)),l.series.donutShowIcons=u.showChartIcons,u.gaugeShowArrow&&(l.series.donutShowArrowIndicator=!0,l.series.donutGap=0,100!==l.series.donutArcPercent&&(l.series.startAngle=0),l.series.donutArrowIndicatorLineColor=u.gaugeArrowLineColor||i.gauge&&i.gauge.arrowIndicator.lineColor,l.series.donutArrowIndicatorFillColor=u.gaugeArrowFillColor||i.gauge&&i.gauge.arrowIndicator.backgroundColor);var d=e.mixin({},i.gauge&&i.gauge.dataLabelStyle,u.gaugeLabelStyle);l.series.donutMainLabelPosition=u.gaugeLabelPlacement,l.series.donutMainLabelFont=s.combineFontString(d),l.series.donutMainLabelFontColor=u.gaugeConditionalStylingLabel?null:d.color,l.series.donutMainLabelFontColorFromConditionalStyling=u.gaugeConditionalStylingLabel&&!!u.conditionalStyling,l.series.donutMainLabelFontSize=u.gaugeLabelStyle&&u.gaugeLabelStyle.fontSize,l.series.donutMainLabelTextDecoration=d.textDecoration;var F=r.seriesItems[0].points[0];l.series.isPercentState=t.isFieldInfoInPercentState(F.fieldInfo)}return r.type===n.RING&&(l.series.show100PercentLabel=!0,l.series.ringBackgroundColor=u.ringBackgroundColor||i.ring&&i.ring.ringBackground&&i.ring.ringBackground.backgroundColor),n.isPictureLike(r.type)&&(l.series.showWholePictures=u.showWholePictures),l.marker.fill="#FFFFFF",l.series.outline=null,l},s.getComparisonSymbol=function(){return a.getMarkerPath(a.CIRCLE)},s.calcColorForPoint=function(e,o,r,a,i,t,s,c,u){var g,d,F=n.isPieLike(t)||!s.renderSingleDataSeriesWithSameColor&&1===i,A=l(t,s);if(t===n.LINE)c&&u?d=u.color||s.comparisonInfo.lineColor:(g=A[a%A.length],d=o.color||g||"#FFFFFF");else if(c&&u&&u.color)d=u.color;else{if(t===n.GAUGE&&1===r&&s.gauge.othersColor)return e&&e.color||s.gauge.othersColor;g=g||(F?A[r%A.length]:A[a%A.length]),d=e&&e.color||!n.isPieLike(t)&&o.color||g||"#FFFFFF"}return d},s.calcColorForSeries=function(e,o,r,a,i){var t,s,c=n.isPieLike(a)||!i.renderSingleDataSeriesWithSameColor&&1===r,u=l(a,i);if(a===n.LINE)t=u[o%u.length],s=e&&e.color||t||"#FFFFFF";else var t=c?null:u[o%u.length],s=e&&e.color||t||"#FFFFFF";return s},s.provideMissingIconsForPoints=function(o,r){if(!n.isPictureLike(r))return null;var a,i=[];o.forEach(function(o){o.iconFieldInfo?(a=o.iconFieldInfo,i.forEach(function(o){o.iconFieldInfo=e.clone(a)}),i.length=0):a?o.iconFieldInfo=e.clone(a):i.push(o)})},s.calcIconForPoint=function(e,o,r){if(!n.isPictureLike(r))return null;var a=e.iconFieldInfo;return a&&a.shapeJson&&o&&(a.shapeJson.themeStyle={fillColor:o,borderColor:o}),a},s.calcBackgroundIconForPoint=function(o,r,a,i){if(!n.isPictureLike(r))return null;var t=i.columnBarBackgroundColor||a.columnBarBackground&&a.columnBarBackground.backgroundColor,l=o.iconFieldInfo;return l&&l.shapeJson&&t?(l=e.clone(l),l.shapeJson.themeStyle={fillColor:t,borderColor:t},l):null},s.combineFontString=function(e){return e=e||{},(e.fontStyle||"normal")+" normal "+(e.fontWeight||"normal")+" "+(e.fontSize||"11")+"px "+(e.fontFamily||r.DEFAULT_FONT_FAMILY_CLASSIC)},s});