// COPYRIGHT Â© 201 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/3.26/esri/copyright.txt for details.

define(["dojo/_base/lang","dojox/charting/Theme","../../themes/ThemeLibrary","./ChartTypes","./ChartLineMarkers","../../supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder"],function(e,o,r,n,a,i){function t(e,o){var r,a=o;switch(e){case n.COLUMN:r=a.column&&a.column.colors;break;case n.BAR:r=a.bar&&a.bar.colors;break;case n.LINE:case n.VERTICAL_LINE:r=a.line&&a.line.colors;break;case n.PIE:r=a.pie&&a.pie.colors;break;case n.DONUT:r=a.donut&&a.donut.colors;break;case n.GAUGE:r=a.gauge&&a.gauge.colors;break;case n.RING:r=a.ring&&a.ring.colors;break;case n.PICTURE_COLUMN:r=a.pictureColumn&&a.pictureColumn.colors;break;case n.PICTURE_BAR:r=a.pictureBar&&a.pictureBar.colors}return r&&r.length||(r=null),r||a.colors||s}var l={},s=["#AAAAAA","#888888","#555555","#333333"];return l.DEFAULT_LINE_THICKNESS=1,l.DEFAULT_COLUMN_THICKNESS="Medium",l.DEFAULT_DONUT_HOLE_PERCENT=50,l.DEFAULT_DONUT_GAP=3,l.DEFAULT_DONUT_ARC_PERCENT=100,l.DEFAULT_GAUGE_HOLE_PERCENT=80,l.DEFAULT_GAUGE_GAP=2,l.DEFAULT_GAUGE_ANGLE=0,l.DEFAULT_GAUGE_ARC_PERCENT=100,l.getThemeForSettings=function(r,a){var t=a,c=new o({colors:t.colors||s});if(!r)return c;var u=r.visualProperties;c.plotarea.fill=u.backgroundColor||t.backgroundColor,c.plotarea.stroke={width:0},c.chart.fill="transparent",c.axis.title.font="normal normal normal 11px Verdana",!n.isPieLike(r.type)&&r.type!==n.RING&&u.backgroundImageData&&(c.plotarea.backgroundImageData=u.backgroundImageData);var g=e.mixin({},t.dataLabelsStyle,u.dataLabelsStyle);if(g.color&&(c.series.fontColor=g.color),c.series.font=l.combineFontString(g),c.series.showColumnBarBackground=u.showColumnBarBackground,c.series.columnBarBackgroundColor=u.columnBarBackgroundColor||t.columnBarBackground&&t.columnBarBackground.backgroundColor,c.series.renderColumnBarsInOppositeDirections=u.renderColumnBarsInOppositeDirections,c.series.baseLineValue=u.yAxis.baseLineValue,r.type===n.DONUT&&(c.series.donutHolePercent=void 0!==u.donutHolePercent?u.donutHolePercent:l.DEFAULT_DONUT_HOLE_PERCENT,c.series.donutGap=void 0!==u.donutGap?u.donutGap:l.DEFAULT_DONUT_GAP,c.series.donutArcPercent=void 0!==u.donutArcPercent?u.donutArcPercent:l.DEFAULT_DONUT_ARC_PERCENT,c.series.donutArcPercent=Math.min(100,Math.max(50,c.series.donutArcPercent))),r.type===n.GAUGE){c.series.donutHolePercent=void 0!==u.gaugeHolePercent?u.gaugeHolePercent:l.DEFAULT_GAUGE_HOLE_PERCENT,c.series.donutGap=void 0!==u.gaugeGap?u.gaugeGap:l.DEFAULT_GAUGE_GAP,c.series.startAngle=void 0!==u.gaugeStartAngle?u.gaugeStartAngle:l.DEFAULT_GAUGE_ANGLE,c.series.donutArcPercent=void 0!==u.gaugeArcPercent?u.gaugeArcPercent:l.DEFAULT_GAUGE_ARC_PERCENT,c.series.donutArcPercent=Math.min(100,Math.max(50,c.series.donutArcPercent)),c.series.donutShowIcons=u.showChartIcons,u.gaugeShowArrow&&(c.series.donutShowArrowIndicator=!0,c.series.donutGap=0,100!==c.series.donutArcPercent&&(c.series.startAngle=0),c.series.donutArrowIndicatorLineColor=u.gaugeArrowLineColor||t.gauge&&t.gauge.arrowIndicator.lineColor,c.series.donutArrowIndicatorFillColor=u.gaugeArrowFillColor||t.gauge&&t.gauge.arrowIndicator.backgroundColor);var d=e.mixin({},t.gauge&&t.gauge.dataLabelStyle,u.gaugeLabelStyle);if(c.series.donutMainLabelPosition=u.gaugeLabelPlacement,c.series.donutMainLabelFont=l.combineFontString(d),c.series.donutMainLabelFontColor=u.gaugeConditionalStylingLabel?null:d.color,c.series.donutMainLabelFontColorFromConditionalStyling=u.gaugeConditionalStylingLabel&&!!u.conditionalStyling,c.series.donutMainLabelFontSize=u.gaugeLabelStyle&&u.gaugeLabelStyle.fontSize,c.series.donutMainLabelTextDecoration=d.textDecoration,u.gaugeShowFromToLabels){c.series.donutShowFromToLabels=u.gaugeShowFromToLabels;var F=e.mixin({},t.gauge&&t.gauge.dataLabelStyle,u.gaugeFromLabelStyle);c.series.donutFromLabelText=u.gaugeRangeMin||0,c.series.donutFromLabelFont=l.combineFontString(F),c.series.donutFromLabelFontColor=F.color,c.series.donutFromLabelFontSize=F.fontSize,c.series.donutFromLabelTextDecoration=F.textDecoration;var L=e.mixin({},t.gauge&&t.gauge.dataLabelStyle,u.gaugeToLabelStyle);c.series.donutToLabelText=u.gaugeRangeMax||"",c.series.donutToLabelFont=l.combineFontString(L),c.series.donutToLabelFontColor=L.color,c.series.donutToLabelFontSize=L.fontSize,c.series.donutToLabelTextDecoration=L.textDecoration}var A=r.seriesItems[0].points[0];c.series.isPercentState=i.isFieldInfoInPercentState(A.fieldInfo)}return r.type===n.RING&&(c.series.show100PercentLabel=!0,c.series.ringBackgroundColor=u.ringBackgroundColor||t.ring&&t.ring.ringBackground&&t.ring.ringBackground.backgroundColor),n.isPictureLike(r.type)&&(c.series.showWholePictures=u.showWholePictures),c.marker.fill="#FFFFFF",c.series.outline=null,c},l.getComparisonSymbol=function(){return a.getMarkerPath(a.CIRCLE)},l.calcColorForPoint=function(e,o,r,a,i,l,s,c,u){var g,d,F=n.isPieLike(l)||!s.renderSingleDataSeriesWithSameColor&&1===i,L=t(l,s);if(n.isLineLike(l))c&&u?d=u.color||s.comparisonInfo.lineColor:(g=L[a%L.length],d=o.color||g||"#FFFFFF");else if(c&&u&&u.color)d=u.color;else{if(l===n.GAUGE&&1===r&&s.gauge.othersColor)return e&&e.color||s.gauge.othersColor;g=g||(F?L[r%L.length]:L[a%L.length]),d=e&&e.color||!n.isPieLike(l)&&o.color||g||"#FFFFFF"}return d},l.calcColorForSeries=function(e,o,r,a,i){var l,s,c=n.isPieLike(a)||!i.renderSingleDataSeriesWithSameColor&&1===r,u=t(a,i);if(n.isLineLike(a))l=u[o%u.length],s=e&&e.color||l||"#FFFFFF";else var l=c?null:u[o%u.length],s=e&&e.color||l||"#FFFFFF";return s},l.provideMissingIconsForPoints=function(o,r){if(!n.isPictureLike(r))return null;var a,i=[];o.forEach(function(o){o.iconFieldInfo?(a=o.iconFieldInfo,i.forEach(function(o){o.iconFieldInfo=e.clone(a)}),i.length=0):a?o.iconFieldInfo=e.clone(a):i.push(o)})},l.calcIconForPoint=function(e,o,r){if(!n.isPictureLike(r))return null;var a=e.iconFieldInfo;return a&&a.shapeJson&&o&&(a.shapeJson.themeStyle={fillColor:o,borderColor:o}),a},l.calcBackgroundIconForPoint=function(o,r,a,i){if(!n.isPictureLike(r))return null;var t=i.columnBarBackgroundColor||a.columnBarBackground&&a.columnBarBackground.backgroundColor,l=o.iconFieldInfo;return l&&l.shapeJson&&t?(l=e.clone(l),l.shapeJson.themeStyle={fillColor:t,borderColor:t},l):null},l.combineFontString=function(e){return e=e||{},(e.fontStyle||"normal")+" normal "+(e.fontWeight||"normal")+" "+(e.fontSize||"11")+"px "+(e.fontFamily||r.DEFAULT_FONT_FAMILY_CLASSIC)},l});