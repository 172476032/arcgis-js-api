// COPYRIGHT Â© 2018 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.6/esri/copyright.txt for details.

define(["require","exports","dojo/Deferred","../../kernel","../kernel","../languageUtils","./centroid","../../geometry/Extent","../../geometry/Geometry","../../geometry/geometryEngineAsync","../../geometry/Multipoint","../../geometry/Point","../../geometry/Polygon","../../geometry/Polyline","../../geometry/support/jsonUtils"],function(n,e,r,t,i,l,o,u,f,a,c,s,g,d,h){function m(n){return v?n.clone():h.fromJSON(n.toJSON())}function w(n){return 0===t.version.indexOf("4.")?g.fromExtent(n):new g({spatialReference:n.spatialReference,rings:[[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]]})}function p(n,e,t){function p(n){if(l.pcCheck(n,2,2),n[0]instanceof f&&n[1]instanceof f);else if(n[0]instanceof f&&null===n[1]);else if(n[1]instanceof f&&null===n[0]);else if(null!==n[0]||null!==n[1])throw new Error("Illegal Argument")}n.disjoint=function(n,e){return t(n,e,function(n,e,r){return p(r),null===r[0]||null===r[1]||a.disjoint(r[0],r[1])})},n.intersects=function(n,e){return t(n,e,function(n,e,r){return p(r),null!==r[0]&&null!==r[1]&&a.intersects(r[0],r[1])})},n.touches=function(n,e){return t(n,e,function(n,e,r){return p(r),null!==r[0]&&null!==r[1]&&a.touches(r[0],r[1])})},n.crosses=function(n,e){return t(n,e,function(n,e,r){return p(r),null!==r[0]&&null!==r[1]&&a.crosses(r[0],r[1])})},n.within=function(n,e){return t(n,e,function(n,e,r){return p(r),null!==r[0]&&null!==r[1]&&a.within(r[0],r[1])})},n.contains=function(n,e){return t(n,e,function(n,e,r){return p(r),null!==r[0]&&null!==r[1]&&a.contains(r[0],r[1])})},n.overlaps=function(n,e){return t(n,e,function(n,e,r){return p(r),null!==r[0]&&null!==r[1]&&a.overlaps(r[0],r[1])})},n.equals=function(n,e){return t(n,e,function(n,e,r){return l.pcCheck(r,2,2),r[0]===r[1]||(r[0]instanceof f&&r[1]instanceof f?a.equals(r[0],r[1]):!(!l.isDate(r[0])||!l.isDate(r[1]))&&r[0].getTime()===r[1].getTime())})},n.relate=function(n,e){return t(n,e,function(n,e,r){if(l.pcCheck(r,3,3),r[0]instanceof f&&r[1]instanceof f)return a.relate(r[0],r[1],l.toString(r[2]));if(r[0]instanceof f&&null===r[1])return!1;if(r[1]instanceof f&&null===r[0])return!1;if(null===r[0]&&null===r[1])return!1;throw new Error("Illegal Argument")})},n.intersection=function(n,e){return t(n,e,function(n,e,r){return p(r),null===r[0]||null===r[1]?null:a.intersect(r[0],r[1])})},n.union=function(n,e){return t(n,e,function(e,r,t){var i=[];if(0===t.length)throw new Error("Function called with wrong number of Parameters");if(1===t.length)if(l.isArray(t[0])){for(var o=0;o<t[0].length;o++)if(null!==t[0][o]){if(!(t[0][o]instanceof f))throw new Error("Illegal Argument");i.push(t[0][o])}}else{if(!l.isImmutableArray(t[0])){if(t[0]instanceof f)return l.fixSpatialReference(m(t[0]),n.spatialReference);if(null===t[0])return null;throw new Error("Illegal Argument")}for(var u=t[0].toArray(),o=0;o<u.length;o++)if(null!==u[o]){if(!(u[o]instanceof f))throw new Error("Illegal Argument");i.push(u[o])}}else for(var o=0;o<t.length;o++)if(null!==t[o]){if(!(t[o]instanceof f))throw new Error("Illegal Argument");i.push(t[o])}return 0===i.length?null:a.union(i)})},n.difference=function(n,e){return t(n,e,function(n,e,r){return p(r),null!==r[0]&&null===r[1]?m(r[0]):null===r[0]?null:a.difference(r[0],r[1])})},n.symmetricdifference=function(n,e){return t(n,e,function(n,e,r){return p(r),null===r[0]&&null===r[1]?null:null===r[0]?m(r[1]):null===r[1]?m(r[0]):a.symmetricDifference(r[0],r[1])})},n.clip=function(n,e){return t(n,e,function(n,e,r){if(l.pcCheck(r,2,2),!(r[1]instanceof u)&&null!==r[1])throw new Error("Illegal Argument");if(null===r[0])return null;if(!(r[0]instanceof f))throw new Error("Illegal Argument");return null===r[1]?null:a.clip(r[0],r[1])})},n.cut=function(n,e){return t(n,e,function(n,e,r){if(l.pcCheck(r,2,2),!(r[1]instanceof d)&&null!==r[1])throw new Error("Illegal Argument");if(null===r[0])return[];if(!(r[0]instanceof f))throw new Error("Illegal Argument");return null===r[1]?[m(r[0])]:a.cut(r[0],r[1])})},n.area=function(n,e){return t(n,e,function(n,e,r){if(l.pcCheck(r,1,2),null===r[0])return 0;if(!(r[0]instanceof f))throw new Error("Illegal Argument");return a.planarArea(r[0],i.convertSquareUnitsToCode(l.defaultUndefined(r[1],-1)))})},n.areageodetic=function(n,e){return t(n,e,function(n,e,r){if(l.pcCheck(r,1,2),null===r[0])return 0;if(!(r[0]instanceof f))throw new Error("Illegal Argument");return a.geodesicArea(r[0],i.convertSquareUnitsToCode(l.defaultUndefined(r[1],-1)))})},n.length=function(n,e){return t(n,e,function(n,e,r){if(l.pcCheck(r,1,2),null===r[0])return 0;if(!(r[0]instanceof f))throw new Error("Illegal Argument");return a.planarLength(r[0],i.convertLinearUnitsToCode(l.defaultUndefined(r[1],-1)))})},n.lengthgeodetic=function(n,e){return t(n,e,function(n,e,r){if(l.pcCheck(r,1,2),null===r[0])return 0;if(!(r[0]instanceof f))throw new Error("Illegal Argument");return a.geodesicLength(r[0],i.convertLinearUnitsToCode(l.defaultUndefined(r[1],-1)))})},n.distance=function(n,e){return t(n,e,function(n,e,r){if(l.pcCheck(r,2,3),!(r[0]instanceof f))throw new Error("Illegal Argument");if(!(r[1]instanceof f))throw new Error("Illegal Argument");return a.distance(r[0],r[1],i.convertLinearUnitsToCode(l.defaultUndefined(r[2],-1)))})},n.densify=function(n,e){return t(n,e,function(n,e,r){if(l.pcCheck(r,2,3),null===r[0])return null;if(!(r[0]instanceof f))throw new Error("Illegal Argument");var t=l.toNumber(r[1]);if(isNaN(t))throw new Error("Illegal Argument");if(t<=0)throw new Error("Illegal Argument");return r[0]instanceof g||r[0]instanceof d?a.densify(r[0],t,i.convertLinearUnitsToCode(l.defaultUndefined(r[2],-1))):r[0]instanceof u?a.densify(w(r[0]),t,i.convertLinearUnitsToCode(l.defaultUndefined(r[2],-1))):r[0]})},n.densifygeodetic=function(n,e){return t(n,e,function(n,e,r){if(l.pcCheck(r,2,3),null===r[0])return null;if(!(r[0]instanceof f))throw new Error("Illegal Argument");var t=l.toNumber(r[1]);if(isNaN(t))throw new Error("Illegal Argument");if(t<=0)throw new Error("Illegal Argument");return r[0]instanceof g||r[0]instanceof d?a.geodesicDensify(r[0],t,i.convertLinearUnitsToCode(l.defaultUndefined(r[2],-1))):r[0]instanceof u?a.geodesicDensify(w(r[0]),t,i.convertLinearUnitsToCode(l.defaultUndefined(r[2],-1))):r[0]})},n.generalize=function(n,e){return t(n,e,function(n,e,r){if(l.pcCheck(r,2,4),null===r[0])return null;if(!(r[0]instanceof f))throw new Error("Illegal Argument");var t=l.toNumber(r[1]);if(isNaN(t))throw new Error("Illegal Argument");return a.generalize(r[0],t,l.toBoolean(l.defaultUndefined(r[2],!0)),i.convertLinearUnitsToCode(l.defaultUndefined(r[3],-1)))})},n.buffer=function(n,e){return t(n,e,function(n,e,r){if(l.pcCheck(r,2,3),null===r[0])return null;if(!(r[0]instanceof f))throw new Error("Illegal Argument");var t=l.toNumber(r[1]);if(isNaN(t))throw new Error("Illegal Argument");return 0===t?m(r[0]):a.buffer(r[0],t,i.convertLinearUnitsToCode(l.defaultUndefined(r[2],-1)))})},n.buffergeodetic=function(n,e){return t(n,e,function(n,e,r){if(l.pcCheck(r,2,3),null===r[0])return null;if(!(r[0]instanceof f))throw new Error("Illegal Argument");var t=l.toNumber(r[1]);if(isNaN(t))throw new Error("Illegal Argument");return 0===t?m(r[0]):a.geodesicBuffer(r[0],t,i.convertLinearUnitsToCode(l.defaultUndefined(r[2],-1)))})},n.offset=function(n,e){return t(n,e,function(n,e,r){if(l.pcCheck(r,2,6),null===r[0])return null;if(!(r[0]instanceof g||r[0]instanceof d))throw new Error("Illegal Argument");var t=l.toNumber(r[1]);if(isNaN(t))throw new Error("Illegal Argument");var o=l.toNumber(l.defaultUndefined(r[4],10));if(isNaN(o))throw new Error("Illegal Argument");var u=l.toNumber(l.defaultUndefined(r[5],0));if(isNaN(u))throw new Error("Illegal Argument");return a.offset(r[0],t,i.convertLinearUnitsToCode(l.defaultUndefined(r[2],-1)),l.toString(l.defaultUndefined(r[3],"round")).toLowerCase(),o,u)})},n.rotate=function(n,e){return t(n,e,function(n,e,r){l.pcCheck(r,2,3);var t=r[0];if(null===t)return null;if(!(t instanceof f))throw new Error("Illegal Argument");t instanceof u&&(t=g.fromExtent(t));var i=l.toNumber(r[1]);if(isNaN(i))throw new Error("Illegal Argument");var o=l.defaultUndefined(r[2],null);if(null===o)return a.rotate(t,i);if(o instanceof s)return a.rotate(t,i,o);throw new Error("Illegal Argument")})},n.centroid=function(n,e){return t(n,e,function(e,r,t){if(l.pcCheck(t,1,1),null===t[0])return null;if(!(t[0]instanceof f))throw new Error("Illegal Argument");return t[0]instanceof s?l.fixSpatialReference(m(t[0]),n.spatialReference):t[0]instanceof g?v?t[0].centroid:t[0].getCentroid():t[0]instanceof d?o.centroidPolyline(t[0]):t[0]instanceof c?o.centroidMultiPoint(t[0]):t[0]instanceof u?v?t[0].center:t[0].getExtent().getCenter():null})},n.multiparttosinglepart=function(n,e){return t(n,e,function(e,t,o){l.pcCheck(o,1,1);var w=[];if(null===o[0])return null;if(!(o[0]instanceof f))throw new Error("Illegal Argument");if(o[0]instanceof s)return[l.fixSpatialReference(m(o[0]),n.spatialReference)];if(o[0]instanceof u)return[l.fixSpatialReference(m(o[0]),n.spatialReference)];var p=new r;return a.simplify(o[0]).then(i.callback(function(e){if(e instanceof g){for(var r=[],t=[],i=0;i<e.rings.length;i++)if(e.isClockwise(e.rings[i])){var u=h.fromJSON({rings:[e.rings[i]],hasZ:e.hasZ,hazM:e.hasM,spatialReference:v?e.spatialReference.toJSON():e.spatialReference.toJson()});r.push(u)}else t.push({ring:e.rings[i],pt:e.getPoint(i,0)});for(var f=0;f<t.length;f++)for(var a=0;a<r.length;a++)if(r[a].contains(t[f].pt)){r[a].addRing(t[f].ring);break}p.resolve(r)}else if(e instanceof d){for(var s=[],i=0;i<e.paths.length;i++){var A=h.fromJSON({paths:[e.paths[i]],hasZ:e.hasZ,hazM:e.hasM,spatialReference:v?e.spatialReference.toJSON():e.spatialReference.toJson()});s.push(A)}p.resolve(s)}else if(o[0]instanceof c){for(var E=l.fixSpatialReference(m(o[0]),n.spatialReference),i=0;i<E.points.length;i++)w.push(E.getPoint(i));p.resolve(w)}else p.resolve(null)},p),i.errback(p)),p.promise})},n.issimple=function(n,e){return t(n,e,function(n,e,r){if(l.pcCheck(r,1,1),null===r[0])return!0;if(r[0]instanceof f)return a.isSimple(r[0]);throw new Error("Illegal Argument")})},n.simplify=function(n,e){return t(n,e,function(n,e,r){if(l.pcCheck(r,1,1),null===r[0])return null;if(r[0]instanceof f)return a.simplify(r[0]);throw new Error("Illegal Argument")})}}Object.defineProperty(e,"__esModule",{value:!0});var v=0===t.version.indexOf("4.");e.registerFunctions=p});